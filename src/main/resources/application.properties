spring.application.name=our-voice-our-rights

# Datasource
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/ourvoiceourrights?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:root}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:password}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.open-in-view=false

# Cache & Redis
spring.cache.type=${CACHE_PROVIDER:caffeine}
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}

# Jackson
spring.jackson.serialization.write-dates-as-timestamps=false

# MVC Problem Details
spring.mvc.problemdetails.enabled=true

# Application-specific
app.data-gov-base-url=https://api.data.gov.in/resource
app.data-gov-resource-id=c8ef53ea-d686-4f02-84a1-f4584790bba6
app.ingestion-schedule-cron=${INGEST_SCHEDULE_CRON:0 0 */6 * * *}
app.ingest-limit=${INGEST_LIMIT:100}

# ingestion default states (indexed list)
app.ingestion.default-states[0]=ANDHRA PRADESH
app.ingestion.default-states[1]=KARNATAKA
app.ingestion.default-states[2]=ODISHA

app.ingestion.rolling-financial-years=3
app.ingestion.max-fetch-limit=500
app.ingestion.pagination-step=100
app.ingestion.max-retry-attempts=${INGEST_MAX_RETRIES:5}
app.ingestion.retry-initial-interval-ms=200
app.ingestion.retry-multiplier=2.0

app.cache.provider-env=${CACHE_PROVIDER:caffeine}
app.cache.states-ttl=PT12H
app.cache.districts-ttl=PT6H
app.cache.latest-performance-ttl=PT30M
app.cache.history-ttl=PT10M

app.geo.geo-ip-database-path=${GEOIP2_DB_PATH:}
app.geo.reverse-geocode-base-url=${REVERSE_GEOCODE_BASE:}
app.geo.reverse-geocode-timeout=PT3S
app.geo.geo-ip-cache-ttl=PT6H

app.rate-limit.requests-per-minute=${RATE_LIMIT_RPM:120}

# Resilience4j
resilience4j.retry.instances.datagov.max-attempts=${INGEST_MAX_RETRIES:5}
resilience4j.retry.instances.datagov.wait-duration=200ms
resilience4j.retry.instances.datagov.exponential-backoff-multiplier=2
resilience4j.retry.instances.datagov.enable-exponential-backoff=true

resilience4j.circuitbreaker.instances.datagov.sliding-window-type=COUNT_BASED
resilience4j.circuitbreaker.instances.datagov.sliding-window-size=20
resilience4j.circuitbreaker.instances.datagov.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.instances.datagov.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.datagov.wait-duration-in-open-state=60s
resilience4j.circuitbreaker.instances.datagov.slow-call-duration-threshold=5s
resilience4j.circuitbreaker.instances.datagov.slow-call-rate-threshold=50

# Management / Actuator
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when_authorized
management.metrics.tags.application=our-voice-our-rights
management.prometheus.metrics.export.enabled=true

# Logging
logging.level.com.ourvoiceourrights=INFO
logging.level.org.springframework.web=INFO
